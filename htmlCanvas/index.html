<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>ğŸ¨ ç”œç¾ç»˜å›¾æ¿ HTML5 Canvas</title>
  </head>
  <body>
    <div class="controls">
      <h1>ğŸ¨ ç”œç¾ç»˜å›¾æ¿</h1>
      <div class="control-group">
        <label>ğŸŒˆ è‰²ç›¸: <span id="hueValue">0</span>Â°</label>
        <input type="range" id="hue" min="0" max="360" value="0" />
      </div>
      <div class="control-group">
        <label>ğŸ’« é¥±å’Œåº¦: <span id="saturationValue">50</span>%</label>
        <input type="range" id="saturation" min="0" max="100" value="50" />
      </div>
      <div class="control-group">
        <label>âœ¨ äº®åº¦: <span id="lightnessValue">50</span>%</label>
        <input type="range" id="lightness" min="0" max="100" value="50" />
      </div>
      <div class="control-group">
        <label>ğŸ–Šï¸ ç²—ç»†: <span id="strokeValue">50</span>px</label>
        <input type="range" id="strokeWidth" min="1" max="100" value="50" />
      </div>
      <div class="control-group">
        <input type="checkbox" id="smoothTransition" checked />
        <label for="smoothTransition">ğŸŒŸ å¹³æ»‘è¿‡æ¸¡</label>
      </div>
      <button id="clearCanvas">ğŸ—‘ï¸ æ¸…ç©ºç”»å¸ƒ</button>
    </div>

    <canvas id="draw" width="900" height="600"></canvas>

    <style>
      * {
        box-sizing: border-box;
      }

      html,
      body {
        margin: 0;
        padding: 0;
        font-family: "Comic Sans MS", cursive, sans-serif;
        background: linear-gradient(45deg, #ffecd2, #fcb69f);
        min-height: 100vh;
      }

      .controls {
        background: rgba(255, 255, 255, 0.9);
        padding: 20px;
        border-radius: 15px;
        margin: 20px;
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 255, 255, 0.2);
      }

      h1 {
        text-align: center;
        color: #e91e63;
        margin: 0 0 20px 0;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
      }

      .control-group {
        margin: 15px 0;
        display: flex;
        align-items: center;
        gap: 10px;
      }

      label {
        font-weight: bold;
        color: #2c3e50;
        min-width: 120px;
        font-size: 14px;
      }

      input[type="range"] {
        flex: 1;
        height: 8px;
        border-radius: 5px;
        background: linear-gradient(to right, #ff9a9e, #fecfef, #fecfef);
        outline: none;
        -webkit-appearance: none;
      }

      input[type="range"]::-webkit-slider-thumb {
        -webkit-appearance: none;
        width: 20px;
        height: 20px;
        border-radius: 50%;
        background: #e91e63;
        cursor: pointer;
        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
      }

      input[type="range"]::-moz-range-thumb {
        width: 20px;
        height: 20px;
        border-radius: 50%;
        background: #e91e63;
        cursor: pointer;
        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
        border: none;
      }

      button {
        background: linear-gradient(45deg, #ff6b6b, #ee5a24);
        color: white;
        border: none;
        padding: 12px 24px;
        border-radius: 25px;
        font-size: 16px;
        font-weight: bold;
        cursor: pointer;
        box-shadow: 0 4px 15px rgba(255, 107, 107, 0.4);
        transition: all 0.3s ease;
        font-family: inherit;
      }

      button:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(255, 107, 107, 0.6);
      }

      #draw {
        display: block;
        margin: 20px auto;
        border-radius: 15px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        background: white;
        cursor: crosshair;
      }

      input[type="checkbox"] {
        width: 18px;
        height: 18px;
        accent-color: #e91e63;
      }
    </style>

    <script>
      const canvas = document.querySelector("#draw");
      const ctx = canvas.getContext("2d");

      // è°ƒæ•´canvasåˆ†è¾¨ç‡
      canvas.width = 900;
      canvas.height = 600;

      // ç»˜å›¾çŠ¶æ€
      let isDrawing = false;
      let lastX = 0;
      let lastY = 0;

      // å½“å‰ç»˜å›¾å‚æ•°
      let currentHue = 0;
      let currentSaturation = 50;
      let currentLightness = 50;
      let currentStroke = 50;

      // æ§åˆ¶å…ƒç´ 
      const hueSlider = document.querySelector("#hue");
      const saturationSlider = document.querySelector("#saturation");
      const lightnessSlider = document.querySelector("#lightness");
      const strokeSlider = document.querySelector("#strokeWidth");
      const smoothTransition = document.querySelector("#smoothTransition");
      const clearButton = document.querySelector("#clearCanvas");

      // æ˜¾ç¤ºå€¼çš„å…ƒç´ 
      const hueValue = document.querySelector("#hueValue");
      const saturationValue = document.querySelector("#saturationValue");
      const lightnessValue = document.querySelector("#lightnessValue");
      const strokeValue = document.querySelector("#strokeValue");

      // è®¾ç½®canvasé»˜è®¤æ ·å¼
      ctx.lineCap = "round";
      ctx.lineJoin = "round";
      ctx.globalCompositeOperation = "multiply";

      function updateColor() {
        return `hsl(${currentHue}, ${currentSaturation}%, ${currentLightness}%)`;
      }

      function startDrawing(e) {
        isDrawing = true;
        [lastX, lastY] = getMousePos(e);

        // ä¿å­˜å½“å‰çš„ç»˜å›¾å‚æ•°
        currentHue = parseInt(hueSlider.value);
        currentSaturation = parseInt(saturationSlider.value);
        currentLightness = parseInt(lightnessSlider.value);
        currentStroke = parseInt(strokeSlider.value);
      }

      function draw(e) {
        if (!isDrawing) return;

        const [currentX, currentY] = getMousePos(e);

        // å¦‚æœå¯ç”¨å¹³æ»‘è¿‡æ¸¡ï¼ŒåŠ¨æ€å˜åŒ–å‚æ•°
        if (smoothTransition.checked) {
          currentHue = parseInt(hueSlider.value);
          currentSaturation = parseInt(saturationSlider.value);
          currentLightness = parseInt(lightnessSlider.value);
          currentStroke = parseInt(strokeSlider.value);
        }

        ctx.strokeStyle = updateColor();
        ctx.lineWidth = currentStroke;

        ctx.beginPath();
        ctx.moveTo(lastX, lastY);
        ctx.lineTo(currentX, currentY);
        ctx.stroke();

        [lastX, lastY] = [currentX, currentY];
      }

      function stopDrawing() {
        isDrawing = false;
      }

      function getMousePos(e) {
        const rect = canvas.getBoundingClientRect();
        return [e.clientX - rect.left, e.clientY - rect.top];
      }

      // æ›´æ–°æ˜¾ç¤ºå€¼
      function updateDisplayValues() {
        hueValue.textContent = hueSlider.value;
        saturationValue.textContent = saturationSlider.value;
        lightnessValue.textContent = lightnessSlider.value;
        strokeValue.textContent = strokeSlider.value;
      }

      // æ¸…ç©ºç”»å¸ƒ
      function clearCanvas() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
      }

      // äº‹ä»¶ç›‘å¬å™¨
      canvas.addEventListener("mousedown", startDrawing);
      canvas.addEventListener("mousemove", draw);
      canvas.addEventListener("mouseup", stopDrawing);
      canvas.addEventListener("mouseout", stopDrawing);

      // è§¦æ‘¸äº‹ä»¶æ”¯æŒ
      canvas.addEventListener("touchstart", (e) => {
        e.preventDefault();
        const touch = e.touches[0];
        const mouseEvent = new MouseEvent("mousedown", {
          clientX: touch.clientX,
          clientY: touch.clientY,
        });
        canvas.dispatchEvent(mouseEvent);
      });

      canvas.addEventListener("touchmove", (e) => {
        e.preventDefault();
        const touch = e.touches[0];
        const mouseEvent = new MouseEvent("mousemove", {
          clientX: touch.clientX,
          clientY: touch.clientY,
        });
        canvas.dispatchEvent(mouseEvent);
      });

      canvas.addEventListener("touchend", (e) => {
        e.preventDefault();
        const mouseEvent = new MouseEvent("mouseup", {});
        canvas.dispatchEvent(mouseEvent);
      });

      // æ»‘å—äº‹ä»¶
      [hueSlider, saturationSlider, lightnessSlider, strokeSlider].forEach(
        (slider) => {
          slider.addEventListener("input", updateDisplayValues);
        }
      );

      // æ¸…ç©ºæŒ‰é’®
      clearButton.addEventListener("click", clearCanvas);

      // åˆå§‹åŒ–æ˜¾ç¤ºå€¼
      updateDisplayValues();

      // æ·»åŠ ä¸€äº›è´´å¿ƒæç¤º
      console.log("ğŸ¨ ç”œç¾ç»˜å›¾æ¿ä½¿ç”¨è¯´æ˜:");
      console.log("âœ¨ æ‹–åŠ¨æ»‘å—å¯ä»¥è°ƒæ•´é¢œè‰²å’Œç²—ç»†");
      console.log("ğŸŒŸ å¯ç”¨å¹³æ»‘è¿‡æ¸¡ï¼Œè¾¹ç”»è¾¹å˜è‰²ï¼");
      console.log("ğŸ–Šï¸ åœç¬”å†ç”»ï¼Œå»¶ç»­ä¸Šæ¬¡çš„è®¾ç½®");
      console.log("ğŸ“± æ”¯æŒè§¦æ‘¸è®¾å¤‡");
    </script>
  </body>
</html>
